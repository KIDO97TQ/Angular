<!-- src/app/features/cart/cart.component.html -->
<div class="cart-page">
    <!-- Loading State -->
    <div *ngIf="isLoading" class="loading-container">
        <div class="spinner"></div>
        <p>Đang tải giỏ hàng...</p>
    </div>

    <!-- Cart Content -->
    <div *ngIf="!isLoading">
        <!-- Header -->
        <section class="cart-header">
            <div class="container">

                <!-- Title (row 1) -->
                <h1 class="page-title">Giỏ hàng của bạn</h1>

                <!-- Actions (row 2) -->
                <div class="cart-header-actions">
                    <button class="back-btn" (click)="continueShopping()">
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                            <path
                                d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" />
                        </svg>
                        Tiếp tục mua sắm
                    </button>

                    <p class="page-subtitle">
                        <i class="bi bi-cart"></i>
                        {{ cartService.totalItems() }} sản phẩm
                    </p>
                </div>

            </div>
        </section>



        <!-- Cart Content -->
        <section class="cart-content">
            <div class="container">
                <div class="cart-layout">

                    <!-- Cart Items -->
                    <div class="cart-items">
                        <div *ngIf="cartService.items().length === 0" class="empty-cart">
                            <svg width="120" height="120" viewBox="0 0 120 120" fill="none">
                                <circle cx="60" cy="60" r="60" fill="#f5f5f5" />
                                <path d="M40 50h40M40 65h40M40 80h25" stroke="#ccc" stroke-width="3"
                                    stroke-linecap="round" />
                            </svg>
                            <h3>Giỏ hàng trống</h3>
                            <p>Hãy thêm sản phẩm để tiếp tục</p>
                            <button class="btn-primary" (click)="continueShopping()">Khám phá ngay</button>
                        </div>

                        <div *ngFor="let item of cartService.items()" class="cart-item">
                            <div class="item-image">
                                <img [src]="item.imageUrl" [alt]="item.productname">
                            </div>
                            <div class="item-details">
                                <h3 class="item-name">{{ item.productname }}</h3>
                                <p class="item-size">Size: {{ item.productsize }}</p>
                                <p class="item-price">{{ item.productprice | currency:'VND':'symbol':'1.0-0' }} <span
                                        class="price-unit">/ ngày</span></p>
                            </div>

                            <div class="item-actions">
                                <input type="checkbox" [checked]="item.selected"
                                    (change)="cartService.toggleSelection(item.id)" />
                                <div class="quantity-control">
                                    <button class="qty-btn" (click)="updateQuantity(item, -1)">
                                        <svg width="16" height="16" viewBox="0 0 16 16" stroke="currentColor"
                                            stroke-width="2" fill="none">
                                            <path d="M3 8h10" />
                                        </svg>
                                    </button>
                                    <span class="qty-display">{{ item.quantity }}</span>
                                    <button class="qty-btn" (click)="updateQuantity(item, 1)">
                                        <svg width="16" height="16" viewBox="0 0 16 16" stroke="currentColor"
                                            stroke-width="2" fill="none">
                                            <path d="M8 3v10M3 8h10" />
                                        </svg>
                                    </button>
                                </div>
                                <button class="remove-btn" (click)="removeItem(item)">
                                    <svg width="20" height="20" viewBox="0 0 20 20" stroke="currentColor"
                                        stroke-width="2" fill="none">
                                        <path d="M6 2h8M3 5h14M4 5l1 11a2 2 0 002 2h6a2 2 0 002-2l1-11M8 9v6M12 9v6" />
                                    </svg>
                                    Xóa
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Summary Sidebar -->
                    <div class="cart-summary" *ngIf="cartService.items().length > 0">
                        <div class="summary-card">
                            <h2 class="summary-title">Thông tin thanh toán</h2>

                            <div class="summary-row">
                                <span class="label">Tổng giá thuê:</span>
                                <span class="value">{{ cartService.selectedTotalPrice() |
                                    currency:'VND':'symbol':'1.0-0'
                                    }}</span>
                            </div>

                            <div class="summary-row highlight">
                                <span class="label">Số lượng sản phẩm:</span>
                                <span class="value">{{ cartService.selectedTotalQuantity() }} món</span>
                                <!-- <span class="value">{{ cartService.items().length }} món</span> -->
                            </div>

                            <div class="summary-divider"></div>

                            <div class="summary-row deposit">
                                <span class="label">
                                    Tiền cọc
                                    <span class="info-icon" title="100.000đ cho mỗi sản phẩm">ⓘ</span>
                                </span>
                                <span class="value total">{{ cartService.depositAmount() |
                                    currency:'VND':'symbol':'1.0-0' }}</span>
                            </div>

                            <div class="deposit-note">
                                <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                    <path d="M8 0a8 8 0 100 16A8 8 0 008 0zm1 12H7V7h2v5zm0-6H7V4h2v2z" />
                                </svg>
                                <p>Bạn chỉ cần thanh toán <strong>100.000đ tiền cọc</strong> cho mỗi sản phẩm. Phần còn
                                    lại sẽ thanh toán khi nhận hàng.</p>
                            </div>

                            <button class="checkout-btn" (click)="proceedToCheckout()">
                                <span>Thanh toán cọc</span>
                                <svg width="20" height="20" viewBox="0 0 20 20" stroke="currentColor" stroke-width="2"
                                    fill="none">
                                    <path d="M4 10h12M12 6l4 4-4 4" />
                                </svg>
                            </button>

                            <button class="continue-btn" (click)="continueShopping()">
                                Tiếp tục mua sắm
                            </button>
                        </div>
                    </div>

                </div>
            </div>
        </section>
    </div>
</div>