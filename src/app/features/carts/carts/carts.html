<!-- src/app/features/cart/cart.component.html -->
<div class="cart-page">
    <!-- Loading State -->
    <div *ngIf="isLoading" class="loading-container">
        <div class="spinner"></div>
        <p>ƒêang t·∫£i gi·ªè h√†ng...</p>
    </div>

    <!-- Cart Content -->
    <div *ngIf="!isLoading">
        <!-- Header -->
        <section class="cart-header">
            <div class="header-background">
                <div class="floating-shape shape-1"></div>
                <div class="floating-shape shape-2"></div>
                <div class="floating-shape shape-3"></div>
                <div class="particles"></div>
            </div>

            <div class="container">
                <div class="header-content">
                    <!-- Left Side: Navigation & Stats -->
                    <div class="header-left">
                        <button class="back-btn" (click)="continueShopping()">
                            <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                                <path
                                    d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" />
                            </svg>
                            Ti·∫øp t·ª•c mua s·∫Øm
                        </button>

                        <div class="title-section">
                            <div class="breadcrumb">
                                <span>Trang ch·ªß</span>
                                <span class="separator">/</span>
                                <span class="active">Gi·ªè h√†ng</span>
                            </div>
                            <h1 class="page-title">
                                <span class="title-icon">üõí</span>
                                Gi·ªè h√†ng c·ªßa b·∫°n
                            </h1>
                            <p class="page-subtitle">
                                <span class="count-badge">{{ cartService.totalItems() }}</span>
                                s·∫£n ph·∫©m ƒëang ch·ªù
                            </p>
                        </div>
                    </div>

                    <!-- Right Side: Quick Stats Cards -->
                    <div class="header-right">
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-icon">üëó</div>
                                <div class="stat-info">
                                    <div class="stat-value">{{ cartService.items().length }}</div>
                                    <div class="stat-label">S·∫£n ph·∫©m</div>
                                </div>
                            </div>

                            <div class="stat-card highlight">
                                <div class="stat-icon">üí≥</div>
                                <div class="stat-info">
                                    <div class="stat-value">{{ cartService.depositAmount() / 1000 }}K</div>
                                    <div class="stat-label">Ti·ªÅn c·ªçc</div>
                                </div>
                            </div>

                            <div class="stat-card">
                                <div class="stat-icon">üí∞</div>
                                <div class="stat-info">
                                    <div class="stat-value">{{ cartService.totalRentPrice() / 1000 }}K</div>
                                    <div class="stat-label">T·ªïng thu√™</div>
                                </div>
                            </div>
                        </div>

                        <div class="promo-banner">
                            <div class="promo-icon">‚ö°</div>
                            <div class="promo-text">
                                <strong>ƒê·ªïi size mi·ªÖn ph√≠</strong> trong v√≤ng 24h tr∆∞·ªõc ng√†y thu√™
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Progress Bar -->
                <div class="progress-section">
                    <div class="progress-bar">
                        <div class="progress-fill" [style.width.%]="getProgressPercentage()"></div>
                    </div>
                    <div class="progress-milestones">
                        <div class="milestone" [class.active]="cartService.items().length >= 1">
                            <div class="milestone-icon">‚úì</div>
                            <span>1 s·∫£n ph·∫©m</span>
                        </div>
                        <div class="milestone" [class.active]="cartService.items().length >= 3">
                            <div class="milestone-icon">üéÅ</div>
                            <span>Ph·ª• ki·ªán ƒëi k√®m</span>
                        </div>
                        <div class="milestone" [class.active]="cartService.items().length >= 5">
                            <div class="milestone-icon">üíé</div>
                            <span>Gi·∫£m 10% gi√° thu√™</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Cart Content -->
        <section class="cart-content">
            <div class="container">
                <div class="cart-layout">

                    <!-- Cart Items -->
                    <div class="cart-items">
                        <div *ngIf="cartService.items().length === 0" class="empty-cart">
                            <svg width="120" height="120" viewBox="0 0 120 120" fill="none">
                                <circle cx="60" cy="60" r="60" fill="#f5f5f5" />
                                <path d="M40 50h40M40 65h40M40 80h25" stroke="#ccc" stroke-width="3"
                                    stroke-linecap="round" />
                            </svg>
                            <h3>Gi·ªè h√†ng tr·ªëng</h3>
                            <p>H√£y th√™m s·∫£n ph·∫©m ƒë·ªÉ ti·∫øp t·ª•c</p>
                            <button class="btn-primary" (click)="continueShopping()">Kh√°m ph√° ngay</button>
                        </div>

                        <div *ngFor="let item of cartService.items()" class="cart-item">
                            <div class="item-image">
                                <img [src]="item.imageUrl" [alt]="item.productname">
                            </div>
                            <div class="item-details">
                                <h3 class="item-name">{{ item.productname }}</h3>
                                <p class="item-size">Size: {{ item.productsize }}</p>
                                <p class="item-price">{{ item.productprice | currency:'VND':'symbol':'1.0-0' }} <span
                                        class="price-unit">/ ng√†y</span></p>
                            </div>
                            <div class="item-actions">
                                <div class="quantity-control">
                                    <button class="qty-btn" (click)="updateQuantity(item, -1)">
                                        <svg width="16" height="16" viewBox="0 0 16 16" stroke="currentColor"
                                            stroke-width="2" fill="none">
                                            <path d="M3 8h10" />
                                        </svg>
                                    </button>
                                    <span class="qty-display">{{ item.quantity }}</span>
                                    <button class="qty-btn" (click)="updateQuantity(item, 1)">
                                        <svg width="16" height="16" viewBox="0 0 16 16" stroke="currentColor"
                                            stroke-width="2" fill="none">
                                            <path d="M8 3v10M3 8h10" />
                                        </svg>
                                    </button>
                                </div>
                                <button class="remove-btn" (click)="removeItem(item)">
                                    <svg width="20" height="20" viewBox="0 0 20 20" stroke="currentColor"
                                        stroke-width="2" fill="none">
                                        <path d="M6 2h8M3 5h14M4 5l1 11a2 2 0 002 2h6a2 2 0 002-2l1-11M8 9v6M12 9v6" />
                                    </svg>
                                    X√≥a
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Summary Sidebar -->
                    <div class="cart-summary" *ngIf="cartService.items().length > 0">
                        <div class="summary-card">
                            <h2 class="summary-title">Th√¥ng tin thanh to√°n</h2>

                            <div class="summary-row">
                                <span class="label">T·ªïng gi√° thu√™:</span>
                                <span class="value">{{ cartService.totalRentPrice() | currency:'VND':'symbol':'1.0-0'
                                    }}</span>
                            </div>

                            <div class="summary-row highlight">
                                <span class="label">S·ªë l∆∞·ª£ng s·∫£n ph·∫©m:</span>
                                <span class="value">{{ cartService.items().length }} m√≥n</span>
                            </div>

                            <div class="summary-divider"></div>

                            <div class="summary-row deposit">
                                <span class="label">
                                    Ti·ªÅn c·ªçc
                                    <span class="info-icon" title="100.000ƒë cho m·ªói s·∫£n ph·∫©m">‚ìò</span>
                                </span>
                                <span class="value total">{{ cartService.depositAmount() |
                                    currency:'VND':'symbol':'1.0-0' }}</span>
                            </div>

                            <div class="deposit-note">
                                <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                    <path d="M8 0a8 8 0 100 16A8 8 0 008 0zm1 12H7V7h2v5zm0-6H7V4h2v2z" />
                                </svg>
                                <p>B·∫°n ch·ªâ c·∫ßn thanh to√°n <strong>100.000ƒë ti·ªÅn c·ªçc</strong> cho m·ªói s·∫£n ph·∫©m. Ph·∫ßn c√≤n
                                    l·∫°i s·∫Ω thanh to√°n khi nh·∫≠n h√†ng.</p>
                            </div>

                            <button class="checkout-btn" (click)="proceedToCheckout()">
                                <span>Thanh to√°n c·ªçc</span>
                                <svg width="20" height="20" viewBox="0 0 20 20" stroke="currentColor" stroke-width="2"
                                    fill="none">
                                    <path d="M4 10h12M12 6l4 4-4 4" />
                                </svg>
                            </button>

                            <button class="continue-btn" (click)="continueShopping()">
                                Ti·∫øp t·ª•c mua s·∫Øm
                            </button>
                        </div>
                    </div>

                </div>
            </div>
        </section>
    </div>
</div>